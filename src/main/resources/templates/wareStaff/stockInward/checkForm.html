<!DOCTYPE html>
<html lang="vi" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>Ki·ªÉm tra phi·∫øu nh·∫≠p kho</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
</head>
<body>
<div class="container mt-4">
    <h3 class="mb-4">üßæ Ki·ªÉm tra phi·∫øu nh·∫≠p kho</h3>

    <div class="row mb-2">
        <div class="col-md-4"><strong>M√£ phi·∫øu:</strong> <span th:text="${stock.inwardCode}">N/A</span></div>
        <div class="col-md-4"><strong>Nh√† cung c·∫•p:</strong> <span th:text="${stock.supplier.supplierName}">N/A</span></div>
        <div class="col-md-4"><strong>Ng∆∞·ªùi t·∫°o:</strong> <span th:text="${stock.user.fullName}">N/A</span></div>
    </div>
    <div class="row mb-2">
        <div class="col-md-4"><strong>Kho nh·∫≠p:</strong> <span th:text="${stock.warehouse.warehouseName}">N/A</span></div>
        <div class="col-md-4"><strong>ƒê∆°n mua h√†ng:</strong> <span th:text="${stock.purchaseOrder.requestCode}">N/A</span></div>
        <div class="col-md-4"><strong>Th·ªùi gian nh·∫≠p:</strong> <span th:text="${#temporals.format(stock.inwardDate, 'dd/MM/yyyy HH:mm')}">N/A</span></div>
    </div>
    <div class="mb-3">
        <strong>Ghi ch√∫:</strong> <span th:text="${stock.notes ?: 'Kh√¥ng c√≥'}">Kh√¥ng c√≥</span>
    </div>

    <hr/>

    <!-- Form ki·ªÉm h√†ng -->
    <form th:action="@{/ware-staff/stock-inward/check}" method="post">
        <input type="hidden" name="stockInwardId" th:value="${stock.stockInwardId}"/>

        <h5 class="mt-4">üì¶ Danh s√°ch s·∫£n ph·∫©m</h5>
        <div class="table-responsive">
            <table class="table table-bordered align-middle text-center">
                <thead class="table-light">
                <tr>
                    <th>ID SP</th>
                    <th>T√™n s·∫£n ph·∫©m</th>
                    <th>S·ªë l∆∞·ª£ng nh·∫≠p</th>
                    <th>ƒê∆°n gi√° nh·∫≠p</th>
                    <th>S·ªë l∆∞·ª£ng hi·ªán t·∫°i</th>
                    <th>S·ªë l∆∞·ª£ng sau nh·∫≠p</th>
                    <th>S·ªë l∆∞·ª£ng th·ª±c t·∫ø</th>
                </tr>
                </thead>
                <tbody>
                <tr th:each="detail : ${stock.details}">
                    <td th:text="${detail.product.productId}">1</td>
                    <td th:text="${detail.product.productName}">S·∫£n ph·∫©m A</td>
                    <td th:text="${detail.quantityReceived}">0</td>
                    <td th:text="${#numbers.formatDecimal(detail.unitPurchasePrice, 0, 'COMMA', 2, 'POINT')}">0.00</td>
                    <td th:text="${inventoryMap[detail.product.productId]?.quantityOnHand ?: 0}">0</td>
                    <td th:text="${(inventoryMap[detail.product.productId]?.quantityOnHand ?: 0) + detail.quantityReceived}">0</td>
                    <td>
                        <input type="number" name="actualQuantities"
                               th:value="${detail.quantityReceived}" min="0"
                               class="form-control" required/>
                    </td>
                </tr>
                </tbody>
            </table>
        </div>

        <div class="d-flex justify-content-between mt-4">
            <a th:href="@{/ware-staff/stock-inward/check-list}" class="btn btn-secondary">‚Üê Quay l·∫°i</a>
            <button class="btn btn-success">‚úî Duy·ªát phi·∫øu</button>
        </div>
    </form>
</div>
</body>
</html>
